(this["webpackJsonpwork-progress"]=this["webpackJsonpwork-progress"]||[]).push([[0],{24:function(e,t,c){},25:function(e,t,c){},3:function(e){e.exports=JSON.parse('{"urls":{"home":"/","bills":"/bills","settings":"/settings"},"localStorageKeys":{"trelloApiKey":"trelloApiKey","trelloApiToken":"trelloApiToken"}}')},34:function(e,t,c){"use strict";c.r(t);var s=c(1),n=c.n(s),a=c(18),l=c.n(a),r=(c(24),c(25),c(4)),i=c(14),o=c.n(i),d=c(0),j=function(e){return Object(d.jsx)("div",{className:"card bg-light bg-gradient",children:Object(d.jsxs)("div",{className:"card-body",children:[Object(d.jsxs)("h6",{className:"card-subtitle mb-2",children:[e.title," ",Object(d.jsx)("span",{className:"badge bg-primary",style:{float:"right"},children:e.badge})]}),Object(d.jsx)("h5",{className:"card-title text-success",children:e.isLoading?"Loading...":Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(o.a,{prefix:"$",separator:",",end:e.value}),e.altCurrencyRatio&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("span",{children:" / "}),Object(d.jsx)(o.a,{suffix:" \u20bd",separator:",",end:e.value*e.altCurrencyRatio})]})]})}),Object(d.jsx)("p",{className:"card-text",children:e.isLoading?"Loading...":e.children})]})})},b=function(e){var t=n.a.useState(localStorage.getItem(e)||""),c=Object(r.a)(t,2),s=c[0],a=c[1];return n.a.useEffect((function(){localStorage.setItem(e,s)}),[s]),[s,a]},u=c(3),h=c(2),O=c(9),m="5f4cdb937afb6a829d4ad8e6",x="5f4cdb937afb6a829d4ad8e7",g="5f4cdb937afb6a829d4ad8ea",f="5f4cdb937afb6a829d4ad8e8",p="5f4cdb937afb6a829d4ad8e9",v=function(e,t,c,s){return fetch("https://api.trello.com/1/lists/".concat(e,"/cards?key=").concat(t,"&token=").concat(c,"&customFieldItems=true")).then((function(e){return e.json()})).then((function(e){return s(e)}))},y=function(e){return e.reduce((function(e,t){return e+ +t.customFieldItems[0].value.number}),0)},N=function(){var e=b(u.localStorageKeys.trelloApiKey),t=Object(r.a)(e,1)[0],c=b(u.localStorageKeys.trelloApiToken),n=Object(r.a)(c,1)[0],a=Object(h.f)();t&&n||a.push(u.urls.settings);var l=Object(s.useState)(!1),i=Object(r.a)(l,2),o=i[0],N=i[1],S=Object(s.useState)(void 0),w=Object(r.a)(S,2),k=w[0],A=w[1],R=Object(s.useState)([]),C=Object(r.a)(R,2),F=C[0],I=C[1],K=Object(s.useState)([]),L=Object(r.a)(K,2),T=L[0],U=L[1],B=Object(s.useState)([]),P=Object(r.a)(B,2),D=P[0],E=P[1],W=Object(s.useState)([]),J=Object(r.a)(W,2),$=J[0],M=J[1],q=Object(s.useState)([]),H=Object(r.a)(q,2),Q=H[0],z=H[1];Object(s.useEffect)((function(){fetch("https://api.exchangeratesapi.io/latest?&base=USD&symbols=RUB").then((function(e){return e.json()})).then((function(e){A(e.rates.RUB)}))}),[]),Object(s.useEffect)((function(){if(t&&n){var e=v(m,t,n,(function(e){return I(e.filter((function(e){return"5f4cdb937afb6a829d4ad8f2"!==e.id})))})),c=v(x,t,n,(function(e){return U(e)})),s=v(f,t,n,(function(e){return E(e)})),a=v(g,t,n,(function(e){return M(e)})),l=v(p,t,n,(function(e){return z(e)}));Promise.all([e,c,s,a,l]).then((function(){return N(!0)}))}}),[m,x,f,g,p,t,n]);var G=y(F),V=y(T),X=y(D),Y=y($),Z=y(Q),_=Q.filter((function(e){return!e.labels||!e.labels.length})),ee=y(_),te=Q.filter((function(e){return e.labels&&e.labels.length})),ce=y(te),se=Math.max(100-ee,0);return Object(d.jsxs)("div",{className:"container",children:[Object(d.jsxs)("div",{className:"row gy-3",children:[Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsxs)(j,{title:"In Queue",value:G,isLoading:!o,altCurrencyRatio:k,children:[F.length," drawings"]})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsxs)(j,{title:"In Progress",value:V,isLoading:!o,altCurrencyRatio:k,children:[T.length," drawings"]})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsxs)(j,{title:"Completed",value:X,isLoading:!o,altCurrencyRatio:k,children:[D.length," drawings"]})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsxs)(j,{title:"In Revision",value:Y,isLoading:!o,altCurrencyRatio:k,children:[$.length," drawings"]})})]}),Object(d.jsx)("br",{}),Object(d.jsxs)("div",{className:"row gy-3",children:[Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsx)(j,{title:"Unpaid",value:ee,isLoading:!o,altCurrencyRatio:k,badge:0===se?"Ready":"",children:Object(d.jsxs)(O.b,{to:u.urls.bills,className:"card-link",children:[_.length," drawings"]})})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsx)(j,{title:"Left to Withdraw",value:se,isLoading:!o,altCurrencyRatio:k,children:0===se?Object(d.jsx)("span",{className:"text-success",children:"Ready to Withdraw"}):"Required to Withdraw"})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsxs)(j,{title:"Paid",value:ce,isLoading:!o,altCurrencyRatio:k,children:[te.length," drawings"]})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsxs)(j,{title:"Total",value:Z,isLoading:!o,altCurrencyRatio:k,children:[Q.length," drawings"]})})]})]})},S=function(){return Object(d.jsxs)("header",{className:"d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-body border-bottom shadow-sm",children:[Object(d.jsx)("p",{className:"h5 my-0 me-md-auto fw-normal",children:"Work Progress"}),Object(d.jsxs)("nav",{className:"my-2 my-md-0 me-md-3",children:[Object(d.jsx)(O.b,{className:"p-2 text-dark",to:u.urls.home,children:"Analytics"}),Object(d.jsx)(O.b,{className:"p-2 text-dark",to:u.urls.bills,children:"Bills"}),Object(d.jsx)(O.b,{className:"p-2 text-dark",to:u.urls.settings,children:"Settings"})]})]})},w=function(){var e=b(u.localStorageKeys.trelloApiKey),t=Object(r.a)(e,2),c=t[0],s=t[1],n=b(u.localStorageKeys.trelloApiToken),a=Object(r.a)(n,2),l=a[0],i=a[1],o=Object(h.f)();return Object(d.jsxs)("div",{className:"container",children:[Object(d.jsx)("h1",{children:"Settings"}),Object(d.jsx)("div",{className:"row",style:{maxWidth:600},children:Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o.push(u.urls.home)},children:[Object(d.jsxs)("div",{className:"mb-3",children:[Object(d.jsx)("label",{htmlFor:"trelloApiKey",className:"form-label",children:"Trello API Key"}),Object(d.jsx)("input",{type:"text",className:"form-control",id:"trelloApiKey","aria-describedby":"emailHelp",value:c,onChange:function(e){s(e.target.value)}})]}),Object(d.jsxs)("div",{className:"mb-3",children:[Object(d.jsx)("label",{htmlFor:"trelloApiToken",className:"form-label",children:"Trello API Token"}),Object(d.jsx)("input",{type:"text",className:"form-control",id:"trelloApiToken",value:l,onChange:function(e){i(e.target.value)}})]}),Object(d.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Save"})]})})]})},k="5f4cdb937afb6a829d4ad8e9",A=function(e,t){var c=t.exec(e);return c&&c[1]?c[1].trim():""},R=function(e){var t=A(e.desc,/Order Number:(.+)$/gm),c=A(e.desc,/Order Type:(.+)$/gm);return"".concat(t," (").concat(c,")")},C=function(){var e=b(u.localStorageKeys.trelloApiKey),t=Object(r.a)(e,1)[0],c=b(u.localStorageKeys.trelloApiToken),n=Object(r.a)(c,1)[0],a=Object(h.f)();t&&n||a.push(u.urls.settings);var l=Object(s.useState)(!1),i=Object(r.a)(l,2),o=(i[0],i[1]),j=Object(s.useState)(void 0),O=Object(r.a)(j,2),m=O[0],x=O[1],g=Object(s.useState)([]),f=Object(r.a)(g,2),p=f[0],v=f[1];Object(s.useEffect)((function(){fetch("https://api.exchangeratesapi.io/latest?&base=USD&symbols=RUB").then((function(e){return e.json()})).then((function(e){x(e.rates.RUB)}))}),[]),Object(s.useEffect)((function(){t&&n&&fetch("https://api.trello.com/1/lists/".concat(k,"/cards?key=").concat(t,"&token=").concat(n,"&customFieldItems=true")).then((function(e){return e.json()})).then((function(e){console.log(e),v(e),o(!0)}))}),[k,t,n]);var y=p.filter((function(e){return!e.labels||!e.labels.length})),N=function(e){return e.reduce((function(e,t){return e+ +t.customFieldItems[0].value.number}),0)}(y);return Object(d.jsx)("div",{className:"container",children:Object(d.jsxs)("div",{className:"row gy-3",children:[Object(d.jsx)("h3",{children:"Unpaid Orders"}),Object(d.jsxs)("table",{className:"table table-hover",children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{scope:"col",children:"#"}),Object(d.jsx)("th",{scope:"col",children:"Description"}),Object(d.jsx)("th",{scope:"col",align:"right",style:{textAlign:"right"},children:"Coast (USD)"}),Object(d.jsx)("th",{scope:"col",align:"right",style:{textAlign:"right"},children:"Coast (RUB)"})]})}),Object(d.jsxs)("tbody",{children:[y.map((function(e,t){return Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{scope:"row",children:t+1}),Object(d.jsx)("td",{children:R(e)}),Object(d.jsx)("td",{align:"right",children:e.customFieldItems[0].value.number}),Object(d.jsxs)("td",{align:"right",children:[m?"".concat((e.customFieldItems[0].value.number*m).toFixed(2)):"N/A"," "]})]},e.id)})),Object(d.jsxs)("tr",{className:"table-success",children:[Object(d.jsx)("th",{scope:"row",children:"Total"}),Object(d.jsx)("td",{colSpan:2,align:"right",children:Object(d.jsx)("b",{children:N})}),Object(d.jsx)("td",{align:"right",children:Object(d.jsx)("b",{children:m?"".concat((N*m).toFixed(2)):"N/A"})})]})]})]})]})})};var F=function(){return Object(d.jsxs)(O.a,{children:[Object(d.jsx)(S,{}),Object(d.jsxs)(h.c,{children:[Object(d.jsx)(h.a,{exact:!0,path:u.urls.settings,component:w}),Object(d.jsx)(h.a,{exact:!0,path:u.urls.bills,component:C}),Object(d.jsx)(h.a,{exact:!0,path:u.urls.home,component:N})]})]})},I=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,35)).then((function(t){var c=t.getCLS,s=t.getFID,n=t.getFCP,a=t.getLCP,l=t.getTTFB;c(e),s(e),n(e),a(e),l(e)}))};l.a.render(Object(d.jsx)(n.a.StrictMode,{children:Object(d.jsx)(F,{})}),document.getElementById("root")),I()}},[[34,1,2]]]);
//# sourceMappingURL=main.4e735a4e.chunk.js.map