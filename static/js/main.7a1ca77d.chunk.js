(this["webpackJsonpwork-progress"]=this["webpackJsonpwork-progress"]||[]).push([[0],{2:function(e){e.exports=JSON.parse('{"urls":{"home":"/","unpaid":"/unpaid","invoiced":"/invoiced","paid":"/paid","settings":"/settings"},"localStorageKeys":{"trelloApiKey":"trelloApiKey","trelloApiToken":"trelloApiToken"},"labels":{"paid":"Paid","invoiced":"Payment Invoiced"},"trelloLists":{"inQueueListId":"5f4cdb937afb6a829d4ad8e6","inProgressListId":"5f4cdb937afb6a829d4ad8e7","inRevisionListId":"5f4cdb937afb6a829d4ad8ea","completedListId":"5f4cdb937afb6a829d4ad8e8","sentToClientListId":"5f4cdb937afb6a829d4ad8e9"}}')},24:function(e,t,c){},25:function(e,t,c){},34:function(e,t,c){"use strict";c.r(t);var n=c(1),s=c.n(n),a=c(18),r=c.n(a),i=(c(24),c(25),c(3)),l=c(14),o=c.n(l),d=c(0),j=function(e){return Object(d.jsx)("div",{className:"card bg-light bg-gradient",children:Object(d.jsxs)("div",{className:"card-body",children:[Object(d.jsxs)("h6",{className:"card-subtitle mb-2",children:[e.title," ",Object(d.jsx)("span",{className:"badge bg-primary",style:{float:"right"},children:e.badge})]}),Object(d.jsx)("h5",{className:"card-title text-success",children:e.isLoading?"Loading...":Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(o.a,{prefix:"$",separator:",",end:e.value}),e.altCurrencyRatio&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("span",{children:" / "}),Object(d.jsx)(o.a,{suffix:" \u20bd",separator:",",end:e.value*e.altCurrencyRatio})]})]})}),Object(d.jsx)("p",{className:"card-text",children:e.isLoading?"Loading...":e.children})]})})},b=function(e){var t=s.a.useState(localStorage.getItem(e)||""),c=Object(i.a)(t,2),n=c[0],a=c[1];return s.a.useEffect((function(){localStorage.setItem(e,n)}),[n]),[n,a]},u=c(2),h=c(4),O=c(6),m=function(e,t,c,n){return fetch("https://api.trello.com/1/lists/".concat(e,"/cards?key=").concat(t,"&token=").concat(c,"&customFieldItems=true")).then((function(e){return e.json()})).then((function(e){return n(e)}))},x=function(e){return fetch("https://api.exchangeratesapi.io/latest?&base=USD&symbols=RUB").then((function(e){return e.json()})).then((function(t){e(t.rates.RUB)}))},f=function(e){return e.reduce((function(e,t){return e+ +t.customFieldItems[0].value.number}),0)},g=function(){var e=b(u.localStorageKeys.trelloApiKey),t=Object(i.a)(e,1)[0],c=b(u.localStorageKeys.trelloApiToken),s=Object(i.a)(c,1)[0],a=Object(h.f)();t&&s||a.push(u.urls.settings);var r=Object(n.useState)(!1),l=Object(i.a)(r,2),o=l[0],g=l[1],p=Object(n.useState)(void 0),v=Object(i.a)(p,2),y=v[0],N=v[1],L=Object(n.useState)([]),S=Object(i.a)(L,2),I=S[0],C=S[1],k=Object(n.useState)([]),A=Object(i.a)(k,2),w=A[0],R=A[1],T=Object(n.useState)([]),K=Object(i.a)(T,2),F=K[0],P=K[1],E=Object(n.useState)([]),U=Object(i.a)(E,2),B=U[0],D=U[1],M=Object(n.useState)([]),$=Object(i.a)(M,2),J=$[0],Q=$[1];Object(n.useEffect)((function(){x((function(e){return N(e)}))}),[]),Object(n.useEffect)((function(){if(t&&s){var e=m(u.trelloLists.inQueueListId,t,s,(function(e){return C(e.filter((function(e){return"5f4cdb937afb6a829d4ad8f2"!==e.id})))})),c=m(u.trelloLists.inProgressListId,t,s,(function(e){return R(e)})),n=m(u.trelloLists.completedListId,t,s,(function(e){return P(e)})),a=m(u.trelloLists.inRevisionListId,t,s,(function(e){return D(e)})),r=m(u.trelloLists.sentToClientListId,t,s,(function(e){return Q(e)}));Promise.all([e,c,n,a,r]).then((function(){return g(!0)}))}}),[t,s]);var W=f(I),H=f(w),q=f(F),z=f(B),G=f(J),V=J.filter((function(e){return!e.labels||!e.labels.length})),X=f(V),Y=J.filter((function(e){return e.labels&&e.labels.some((function(e){return e.name===u.labels.invoiced}))})),Z=f(Y),_=J.filter((function(e){return e.labels&&e.labels.some((function(e){return e.name===u.labels.paid}))})),ee=f(_),te=Math.max(100-X,0);return Object(d.jsxs)("div",{className:"container",children:[Object(d.jsxs)("div",{className:"row gy-3",children:[Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsxs)(j,{title:"In Queue",value:W,isLoading:!o,altCurrencyRatio:y,children:[I.length," drawing(s)"]})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsxs)(j,{title:"In Progress",value:H,isLoading:!o,altCurrencyRatio:y,children:[w.length," drawing(s)"]})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsxs)(j,{title:"Completed",value:q,isLoading:!o,altCurrencyRatio:y,children:[F.length," drawing(s)"]})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsxs)(j,{title:"In Revision",value:z,isLoading:!o,altCurrencyRatio:y,children:[B.length," drawing(s)"]})})]}),Object(d.jsx)("br",{}),Object(d.jsxs)("div",{className:"row gy-3",children:[Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsx)(j,{title:"Unpaid",value:X,isLoading:!o,altCurrencyRatio:y,badge:0===te?"Ready":"",children:Object(d.jsxs)(O.b,{to:u.urls.unpaid,className:"card-link",children:[V.length," drawing(s)"]})})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsx)(j,{title:"Invoiced",value:Z,isLoading:!o,altCurrencyRatio:y,children:Object(d.jsxs)(O.b,{to:u.urls.invoiced,className:"card-link",children:[Y.length," drawing(s)"]})})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsx)(j,{title:"Paid",value:ee,isLoading:!o,altCurrencyRatio:y,children:Object(d.jsxs)(O.b,{to:u.urls.paid,className:"card-link",children:[_.length," drawing(s)"]})})}),Object(d.jsx)("div",{className:"col-lg",children:Object(d.jsxs)(j,{title:"Total",value:G,isLoading:!o,altCurrencyRatio:y,children:[J.length," drawing(s)"]})})]})]})},p=function(){return Object(d.jsxs)("header",{className:"d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-body border-bottom shadow-sm",children:[Object(d.jsx)("p",{className:"h5 my-0 me-md-auto fw-normal",children:"Work Progress"}),Object(d.jsxs)("nav",{className:"my-2 my-md-0 me-md-3",children:[Object(d.jsx)(O.b,{className:"p-2 text-dark",to:u.urls.home,children:"Analytics"}),Object(d.jsx)(O.b,{className:"p-2 text-dark",to:u.urls.unpaid,children:"Unpaid"}),Object(d.jsx)(O.b,{className:"p-2 text-dark",to:u.urls.invoiced,children:"Invoiced"}),Object(d.jsx)(O.b,{className:"p-2 text-dark",to:u.urls.paid,children:"Paid"}),Object(d.jsx)(O.b,{className:"p-2 text-dark",to:u.urls.settings,children:"Settings"})]})]})},v=function(){var e=b(u.localStorageKeys.trelloApiKey),t=Object(i.a)(e,2),c=t[0],n=t[1],s=b(u.localStorageKeys.trelloApiToken),a=Object(i.a)(s,2),r=a[0],l=a[1],o=Object(h.f)();return Object(d.jsxs)("div",{className:"container",children:[Object(d.jsx)("h1",{children:"Settings"}),Object(d.jsx)("div",{className:"row",style:{maxWidth:600},children:Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o.push(u.urls.home)},children:[Object(d.jsxs)("div",{className:"mb-3",children:[Object(d.jsx)("label",{htmlFor:"trelloApiKey",className:"form-label",children:"Trello API Key"}),Object(d.jsx)("input",{type:"text",className:"form-control",id:"trelloApiKey","aria-describedby":"emailHelp",value:c,onChange:function(e){n(e.target.value)}})]}),Object(d.jsxs)("div",{className:"mb-3",children:[Object(d.jsx)("label",{htmlFor:"trelloApiToken",className:"form-label",children:"Trello API Token"}),Object(d.jsx)("input",{type:"text",className:"form-control",id:"trelloApiToken",value:r,onChange:function(e){l(e.target.value)}})]}),Object(d.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Save"})]})})]})},y=function(e,t){var c=t.exec(e);return c&&c[1]?c[1].trim():""},N=function(e){var t=y(e.desc,/Order Number:(.+)$/gm),c=y(e.desc,/Order Type:(.+)$/gm);return"Order Number: ".concat(t," (").concat(c||e.name,")")},L=function(e){var t=e.cards.reduce((function(e,t){return e+ +t.customFieldItems[0].value.number}),0);return Object(d.jsxs)("table",{className:"table table-hover table-striped",children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{scope:"col",children:"#"}),Object(d.jsx)("th",{scope:"col",children:"Description"}),Object(d.jsx)("th",{scope:"col",align:"right",style:{textAlign:"right"},children:"Cost (USD)"}),Object(d.jsx)("th",{scope:"col",align:"right",style:{textAlign:"right"},children:"Cost (RUB)"}),Object(d.jsx)("th",{scope:"col",align:"right",style:{textAlign:"right"},children:"Link"})]})}),Object(d.jsx)("tbody",{children:e.cards.map((function(t,c){return Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{scope:"row",children:c+1}),Object(d.jsx)("td",{children:N(t)}),Object(d.jsx)("td",{align:"right",children:t.customFieldItems[0].value.number}),Object(d.jsx)("td",{align:"right",children:e.altCurrencyRatio?"".concat((t.customFieldItems[0].value.number*e.altCurrencyRatio).toFixed(0)):"N/A"}),Object(d.jsx)("td",{align:"right",children:Object(d.jsx)("a",{href:t.shortUrl,className:"link-primary",children:"Link"})})]},t.id)}))}),Object(d.jsx)("tfoot",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{scope:"row",children:"Total"}),Object(d.jsx)("td",{colSpan:2,align:"right",children:Object(d.jsxs)("b",{children:["$",t]})}),Object(d.jsx)("td",{align:"right",children:Object(d.jsx)("b",{children:e.altCurrencyRatio?"".concat((t*e.altCurrencyRatio).toFixed(0),"\u20bd"):"N/A"})}),Object(d.jsx)("td",{})]})})]})},S=function(){var e=b(u.localStorageKeys.trelloApiKey),t=Object(i.a)(e,1)[0],c=b(u.localStorageKeys.trelloApiToken),s=Object(i.a)(c,1)[0],a=Object(h.f)();t&&s||a.push(u.urls.settings);var r=Object(n.useState)(!1),l=Object(i.a)(r,2),o=l[0],j=l[1],O=Object(n.useState)(void 0),f=Object(i.a)(O,2),g=f[0],p=f[1],v=Object(n.useState)([]),y=Object(i.a)(v,2),N=y[0],S=y[1];return Object(n.useEffect)((function(){x((function(e){return p(e)}))}),[]),Object(n.useEffect)((function(){t&&s&&m(u.trelloLists.sentToClientListId,t,s,(function(e){return S(e.filter((function(e){return!e.labels||!e.labels.length})))})).then((function(){return j(!0)}))}),[t,s]),Object(d.jsxs)("div",{className:"container",children:[Object(d.jsx)("div",{className:"row gy-3",children:Object(d.jsxs)("div",{className:"col",children:[Object(d.jsx)("h3",{children:"Unpaid Orders"}),o?Object(d.jsx)(L,{cards:N,altCurrencyRatio:g}):"Loading..."]})}),Object(d.jsx)("div",{className:"row gy-3 ",children:Object(d.jsx)("div",{className:"col",children:Object(d.jsx)("button",{type:"button",className:"btn btn-outline-primary",children:"Create an Invoice"})})})]})},I=function(){var e=b(u.localStorageKeys.trelloApiKey),t=Object(i.a)(e,1)[0],c=b(u.localStorageKeys.trelloApiToken),s=Object(i.a)(c,1)[0],a=Object(h.f)();t&&s||a.push(u.urls.settings);var r=Object(n.useState)(!1),l=Object(i.a)(r,2),o=l[0],j=l[1],O=Object(n.useState)(void 0),f=Object(i.a)(O,2),g=f[0],p=f[1],v=Object(n.useState)([]),y=Object(i.a)(v,2),N=y[0],S=y[1];return Object(n.useEffect)((function(){x((function(e){return p(e)}))}),[]),Object(n.useEffect)((function(){t&&s&&m(u.trelloLists.sentToClientListId,t,s,(function(e){return S(e.filter((function(e){return e.labels&&e.labels.some((function(e){return e.name===u.labels.invoiced}))})))})).then((function(){return j(!0)}))}),[t,s]),Object(d.jsxs)("div",{className:"container",children:[Object(d.jsx)("div",{className:"row gy-3",children:Object(d.jsxs)("div",{className:"col",children:[Object(d.jsx)("h3",{children:"Invoiced Orders"}),o?Object(d.jsx)(L,{cards:N,altCurrencyRatio:g}):"Loading..."]})}),Object(d.jsxs)("div",{className:"row gy-3 ",children:[Object(d.jsx)("div",{className:"col",children:Object(d.jsx)("button",{type:"button",className:"btn btn-outline-secondary",children:"Make Unpaid"})}),Object(d.jsx)("div",{className:"col text-end",children:Object(d.jsx)("button",{type:"button",className:"btn btn-outline-primary",children:"Make Paid"})})]})]})},C=function(){var e=b(u.localStorageKeys.trelloApiKey),t=Object(i.a)(e,1)[0],c=b(u.localStorageKeys.trelloApiToken),s=Object(i.a)(c,1)[0],a=Object(h.f)();t&&s||a.push(u.urls.settings);var r=Object(n.useState)(!1),l=Object(i.a)(r,2),o=l[0],j=l[1],O=Object(n.useState)(void 0),f=Object(i.a)(O,2),g=f[0],p=f[1],v=Object(n.useState)([]),y=Object(i.a)(v,2),N=y[0],S=y[1];return Object(n.useEffect)((function(){x((function(e){return p(e)}))}),[]),Object(n.useEffect)((function(){t&&s&&m(u.trelloLists.sentToClientListId,t,s,(function(e){return S(e.filter((function(e){return e.labels&&e.labels.some((function(e){return e.name===u.labels.paid}))})))})).then((function(){return j(!0)}))}),[t,s]),Object(d.jsx)("div",{className:"container",children:Object(d.jsx)("div",{className:"row gy-3",children:Object(d.jsxs)("div",{className:"col",children:[Object(d.jsx)("h3",{children:"Paid Orders"}),o?Object(d.jsx)(L,{cards:N,altCurrencyRatio:g}):"Loading..."]})})})};var k=function(){return Object(d.jsxs)(O.a,{children:[Object(d.jsx)(p,{}),Object(d.jsxs)(h.c,{children:[Object(d.jsx)(h.a,{exact:!0,path:u.urls.settings,component:v}),Object(d.jsx)(h.a,{exact:!0,path:u.urls.unpaid,component:S}),Object(d.jsx)(h.a,{exact:!0,path:u.urls.invoiced,component:I}),Object(d.jsx)(h.a,{exact:!0,path:u.urls.paid,component:C}),Object(d.jsx)(h.a,{exact:!0,path:u.urls.home,component:g})]})]})},A=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,35)).then((function(t){var c=t.getCLS,n=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;c(e),n(e),s(e),a(e),r(e)}))};r.a.render(Object(d.jsx)(s.a.StrictMode,{children:Object(d.jsx)(k,{})}),document.getElementById("root")),A()}},[[34,1,2]]]);
//# sourceMappingURL=main.7a1ca77d.chunk.js.map