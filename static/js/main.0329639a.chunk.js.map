{"version":3,"sources":["Components/Card.tsx","hooks/useStateWithLocalStorage.ts","utils.ts","Components/Analytics.tsx","Components/Header.tsx","Components/Settings.tsx","Components/CardsList.tsx","Components/UnpaidDrawings.tsx","Components/InvoicedDrawings.tsx","Components/PaidDrawings.tsx","Components/App.tsx","reportWebVitals.ts","index.tsx"],"names":["Card","props","className","title","style","float","badge","isLoading","prefix","separator","end","value","altCurrencyRatio","suffix","children","useStateWithLocalStorage","localStorageKey","React","useState","localStorage","getItem","setValue","useEffect","setItem","getCards","listId","apiKey","apiToken","callback","fetch","then","r","json","data","filter","c","customFieldItems","number","getExchangeRate","rates","RUB","addLabelToCard","cardId","labelId","method","removeLabelFromCard","getPayPalAuthToken","clientId","secret","credentials","btoa","headers","Headers","append","body","URLSearchParams","redirect","getPayPalInvoiceTemplate","authToken","createDraftInvoice","template","cards","itemName","template_info","items","name","map","description","getShortCardDescription","unit_amount","currency_code","quantity","requestOptions","JSON","stringify","getFirstGroup","string","regex","match","exec","trim","card","orderNumber","desc","orderType","result","split","getTotal","reduce","summ","Analytics","config","localStorageKeys","trelloApiKey","trelloApiToken","history","useHistory","push","urls","settings","isLoaded","setIsCardsLoaded","undefined","setAltCurrencyRatio","inQueueCards","setInQueueCards","inProgressCards","setInProgressCards","completedCards","setCompletedCards","inRevisionCards","setInRevisionCards","sentToClientCards","setSentToClientCards","inQueueCardsPromise","trelloLists","inQueueListId","id","inProgressCardsPromise","inProgressListId","compleatedCardsPromise","completedListId","inRevisionCardsPromise","inRevisionListId","sentToClientCardsPromise","sentToClientListId","Promise","all","inQueueTotal","inProgressTotal","completedTotal","inRevisionTotal","sentToClientTotal","currentCards","labels","length","currentTotal","invoicedCards","some","l","labelsId","invoiced","invoicedTotal","paidCards","paid","paidTotal","leftToMinimumRedraw","Math","max","badgeText","to","unpaid","Header","home","Settings","setTrelloApiKey","setTrelloApiToken","payPalClientId","setPayPalClientId","payPalSecret","setPayPalSecret","maxWidth","onSubmit","e","preventDefault","htmlFor","type","aria-describedby","onChange","target","CardsList","scope","align","textAlign","i","href","shortUrl","toFixed","colSpan","UnpaidDrawings","setIsLoaded","unpaidCards","setUnpaidCards","invoidedCards","setInvoicedCards","unpaidPromise","invoicedPromise","handleCreateInvoiceClick","a","token","response","chunks","invoiceId","url","window","open","handleMakeCardsInvoicedClick","promises","invoiceButtonText","isInvoiceButtonDisabled","disabled","onClick","InvoicedDrawings","setCards","promisesForRemoving","promisesForAdding","PaidDrawings","App","exact","path","component","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.0329639a.chunk.js","sourcesContent":["import CountUp from 'react-countup';\r\n\r\nexport interface CardProps {\r\n  isLoading: boolean;\r\n  title: string;\r\n  value: number;\r\n  altCurrencyRatio?: number;\r\n  badge?: string;\r\n}\r\n\r\nconst Card: React.FC<CardProps> = (props) => {\r\n  return (\r\n    <div className=\"card bg-light bg-gradient\">\r\n      <div className=\"card-body\">\r\n        <h6 className=\"card-subtitle mb-2\">{props.title} <span className=\"badge bg-primary\" style={{float: 'right'}}>{props.badge}</span></h6>\r\n        <h5 className=\"card-title text-success\">\r\n          {!props.isLoading \r\n            ? <>\r\n                <CountUp prefix=\"$\" separator=\",\" end={props.value} />\r\n                {props.altCurrencyRatio && <><span> / </span><CountUp suffix=\" ₽\" separator=\",\" end={props.value * props.altCurrencyRatio} /></>} \r\n              </>\r\n            : 'Loading...'}\r\n        </h5>\r\n        <p className=\"card-text\">{!props.isLoading ? props.children : 'Loading...'}</p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Card;","import React from \"react\";\r\n\r\nconst useStateWithLocalStorage = (localStorageKey: string): [string, React.Dispatch<React.SetStateAction<string>>] => {\r\n  const [value, setValue] = React.useState(\r\n    localStorage.getItem(localStorageKey) || ''\r\n  );\r\n \r\n  React.useEffect(() => {\r\n    localStorage.setItem(localStorageKey, value);\r\n  }, [value]);\r\n \r\n  return [value, setValue];\r\n};\r\n\r\nexport default useStateWithLocalStorage;","import { TrelloCard } from './types';\r\n\r\nexport const getCards = (listId: string, apiKey: string, apiToken: string, callback: (data: TrelloCard[]) => void): Promise<any> => {\r\n  return fetch(`https://api.trello.com/1/lists/${listId}/cards?key=${apiKey}&token=${apiToken}&customFieldItems=true`)\r\n    .then(r => r.json())\r\n    .then((data: TrelloCard[]) => callback(data.filter(c => c.customFieldItems[0]?.value?.number)));\r\n}\r\nexport const getExchangeRate = (callback: (rate: number) => void): Promise<any> => {\r\n  return fetch('https://api.exchangeratesapi.io/latest?&base=USD&symbols=RUB')\r\n    .then(r => r.json())\r\n    .then(data => {\r\n      callback(data.rates.RUB);\r\n    });\r\n}\r\n\r\nexport const addLabelToCard = (cardId: string, labelId: string, apiKey: string, apiToken: string) => {\r\n  return fetch(`https://api.trello.com/1/cards/${cardId}/idLabels?key=${apiKey}&token=${apiToken}&value=${labelId}`, { method: 'POST' });\r\n}\r\n\r\nexport const removeLabelFromCard = (cardId: string, labelId: string, apiKey: string, apiToken: string) => {\r\n  return fetch(`https://api.trello.com/1/cards/${cardId}/idLabels/${labelId}?key=${apiKey}&token=${apiToken}`, { method: 'DELETE' });\r\n}\r\n\r\nexport const getPayPalAuthToken = (clientId: string, secret: string): Promise<string> => {\r\n  const credentials = btoa(`${clientId}:${secret}`);\r\n  \r\n  const headers = new Headers();\r\n  headers.append('Authorization', `Basic ${credentials}`);\r\n  headers.append('Content-Type', 'application/x-www-form-urlencoded');\r\n\r\n  const body = new URLSearchParams();\r\n  body.append('grant_type', 'client_credentials');\r\n\r\n  const requestOptions: RequestInit = { method: 'POST', headers, body, redirect: 'follow' };\r\n\r\n  return fetch('https://api-m.paypal.com/v1/oauth2/token', requestOptions)\r\n    .then(r => r.json())\r\n    .then(data => data['access_token'] as string);\r\n}\r\n\r\nexport const getPayPalInvoiceTemplate = (authToken: string): Promise<{}> => {\r\n  const headers = new Headers();\r\n  headers.append('Authorization', `Bearer ${authToken}`);\r\n  headers.append('Content-Type', 'application/json');\r\n\r\n  const requestOptions: RequestInit = { method: 'GET', headers, redirect: 'follow' };\r\n\r\n  return fetch('https://api.paypal.com/v2/invoicing/templates/TEMP-0XJ98350B9132814N', requestOptions)\r\n    .then(r => r.json())\r\n}\r\n\r\nexport const createDraftInvoice = (authToken: string, template: any, cards: TrelloCard[]): Promise<{}> => {\r\n  const headers = new Headers();\r\n  headers.append('Authorization', `Bearer ${authToken}`);\r\n  headers.append('Content-Type', 'application/json');\r\n\r\n  const itemName = template.template_info.items[0].name;\r\n\r\n  const data = template.template_info;\r\n  data.items = cards.map(c => ({\r\n    name: itemName,\r\n    description: getShortCardDescription(c),\r\n    unit_amount: { currency_code: 'USD', value: c.customFieldItems[0].value.number },\r\n    quantity: 1,\r\n  }));\r\n\r\n  const requestOptions: RequestInit = { method: 'POST', headers, body: JSON.stringify(data), redirect: 'follow' };\r\n\r\n  return fetch('https://api.paypal.com/v2/invoicing/invoices', requestOptions)\r\n    .then(r => r.json())\r\n}\r\n\r\nconst getFirstGroup = (string: string, regex: RegExp): string => {\r\n  const match = regex.exec(string);\r\n  return match && match[1] ? match[1].trim() : '';\r\n}\r\n\r\nexport const getShortCardDescription = (card: TrelloCard): string => {\r\n  const orderNumber = getFirstGroup(card.desc, /Order Number:(.+)$/gm);\r\n  const orderType = getFirstGroup(card.desc, /Order Type:(.+)$/gm);\r\n\r\n  let result = '';\r\n  if (orderNumber) {\r\n    result += `Order Number: ${orderNumber} (${orderType || card.name})`\r\n  } else {\r\n    result += `Order Number: ${card.name} (${card.desc.split('\\n')[0]})`;\r\n  }\r\n\r\n  return result;\r\n}","import React, { useEffect, useState } from \"react\";\r\nimport Card from \"./Card\";\r\nimport useStateWithLocalStorage from \"../hooks/useStateWithLocalStorage\";\r\nimport config from '../config.json';\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { TrelloCard } from \"../types\";\r\nimport { getCards, getExchangeRate } from \"../utils\";\r\n\r\nconst getTotal = (cards: TrelloCard[]): number => {\r\n  return cards.reduce((summ, c) => summ += +c.customFieldItems[0].value.number, 0);\r\n}\r\n\r\nconst Analytics = () => {\r\n  const [apiKey] = useStateWithLocalStorage(config.localStorageKeys.trelloApiKey);\r\n  const [apiToken] = useStateWithLocalStorage(config.localStorageKeys.trelloApiToken);\r\n\r\n  const history = useHistory();\r\n  if (!apiKey || !apiToken) {\r\n    history.push(config.urls.settings);\r\n  }\r\n\r\n  const [isLoaded, setIsCardsLoaded] = useState<boolean>(false);\r\n  const [altCurrencyRatio, setAltCurrencyRatio] = useState<number | undefined>(undefined);\r\n  const [inQueueCards, setInQueueCards] = useState<TrelloCard[]>([]);\r\n  const [inProgressCards, setInProgressCards] = useState<TrelloCard[]>([]);\r\n  const [completedCards, setCompletedCards] = useState<TrelloCard[]>([]);\r\n  const [inRevisionCards, setInRevisionCards] = useState<TrelloCard[]>([]);\r\n  const [sentToClientCards, setSentToClientCards] = useState<TrelloCard[]>([]);\r\n\r\n  useEffect(() => {\r\n    getExchangeRate(data => setAltCurrencyRatio(data))\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!apiKey || !apiToken) {\r\n      return;\r\n    }\r\n\r\n    const inQueueCardsPromise = getCards(config.trelloLists.inQueueListId, apiKey, apiToken, (data) => setInQueueCards(data.filter(c => c.id !== '5f4cdb937afb6a829d4ad8f2')));\r\n    const inProgressCardsPromise = getCards(config.trelloLists.inProgressListId, apiKey, apiToken, (data) => setInProgressCards(data));\r\n    const compleatedCardsPromise = getCards(config.trelloLists.completedListId, apiKey, apiToken, (data) => setCompletedCards(data));\r\n    const inRevisionCardsPromise = getCards(config.trelloLists.inRevisionListId, apiKey, apiToken, (data) => setInRevisionCards(data));\r\n    const sentToClientCardsPromise = getCards(config.trelloLists.sentToClientListId, apiKey, apiToken, (data) => setSentToClientCards(data));\r\n\r\n    Promise.all([inQueueCardsPromise, inProgressCardsPromise, compleatedCardsPromise, inRevisionCardsPromise, sentToClientCardsPromise])\r\n      .then(() => setIsCardsLoaded(true));\r\n\r\n  }, [apiKey, apiToken]);\r\n\r\n\r\n  const inQueueTotal = getTotal(inQueueCards);\r\n  const inProgressTotal = getTotal(inProgressCards);\r\n  const completedTotal = getTotal(completedCards);\r\n  const inRevisionTotal = getTotal(inRevisionCards);\r\n  const sentToClientTotal = getTotal(sentToClientCards);\r\n\r\n  const currentCards = sentToClientCards.filter(c => !c.labels || !c.labels.length);\r\n  const currentTotal = getTotal(currentCards);\r\n\r\n  const invoicedCards = sentToClientCards.filter(c => c.labels && c.labels.some(l => l.id === config.labelsId.invoiced));\r\n  const invoicedTotal = getTotal(invoicedCards);\r\n\r\n  const paidCards = sentToClientCards.filter(c => c.labels && c.labels.some(l => l.id === config.labelsId.paid));\r\n  const paidTotal = getTotal(paidCards);\r\n\r\n  const leftToMinimumRedraw = Math.max(100 - currentTotal, 0);\r\n\r\n  const badgeText = isLoaded \r\n    ? leftToMinimumRedraw === 0 ? 'Ready' : `Earn more $${leftToMinimumRedraw}`\r\n    : '';\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"row gy-3\">\r\n        <div className=\"col-lg\">\r\n          <Card title=\"Unpaid\" value={currentTotal} isLoading={!isLoaded} altCurrencyRatio={altCurrencyRatio} badge={badgeText}>\r\n            <Link to={config.urls.unpaid} className=\"card-link link-dark\">{currentCards.length} drawing(s)</Link>\r\n          </Card>\r\n        </div>\r\n        <div className=\"col-lg\">\r\n          <Card title=\"Invoiced\" value={invoicedTotal} isLoading={!isLoaded} altCurrencyRatio={altCurrencyRatio}>\r\n            <Link to={config.urls.invoiced} className=\"card-link link-dark\">{invoicedCards.length} drawing(s)</Link>\r\n          </Card>\r\n        </div>\r\n        <div className=\"col-lg\">\r\n          <Card title=\"Paid\" value={paidTotal} isLoading={!isLoaded} altCurrencyRatio={altCurrencyRatio}>\r\n            <Link to={config.urls.paid} className=\"card-link link-dark\">{paidCards.length} drawing(s)</Link>\r\n          </Card>\r\n        </div>\r\n        <div className=\"col-lg\">\r\n          <Card title=\"Total\" value={sentToClientTotal} isLoading={!isLoaded} altCurrencyRatio={altCurrencyRatio}>\r\n            {sentToClientCards.length} drawing(s)\r\n          </Card>\r\n        </div>\r\n      </div>\r\n      <br />\r\n      <div className=\"row gy-3\">\r\n        <div className=\"col-lg\">\r\n          <Card title=\"In Queue\" value={inQueueTotal} isLoading={!isLoaded} altCurrencyRatio={altCurrencyRatio}>\r\n            {inQueueCards.length} drawing(s)\r\n          </Card>\r\n        </div>\r\n        <div className=\"col-lg\">\r\n          <Card title=\"In Progress\" value={inProgressTotal} isLoading={!isLoaded} altCurrencyRatio={altCurrencyRatio}>\r\n            {inProgressCards.length} drawing(s)\r\n          </Card>\r\n        </div>\r\n        <div className=\"col-lg\">\r\n          <Card title=\"Completed\" value={completedTotal} isLoading={!isLoaded} altCurrencyRatio={altCurrencyRatio}>\r\n            {completedCards.length} drawing(s)\r\n          </Card>\r\n        </div>\r\n        <div className=\"col-lg\">\r\n          <Card title=\"In Revision\" value={inRevisionTotal} isLoading={!isLoaded} altCurrencyRatio={altCurrencyRatio}>\r\n            {inRevisionCards.length} drawing(s)\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default Analytics;","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport config from '../config.json';\r\n\r\nconst Header = () => {\r\n  return (\r\n    <header className=\"d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-body border-bottom shadow-sm\">\r\n      <p className=\"h5 my-0 me-md-auto fw-normal\">Work Progress</p>\r\n      <nav className=\"my-2 my-md-0 me-md-3\">\r\n        <Link className=\"p-2 text-dark\" to={config.urls.home}>Analytics</Link>\r\n        <Link className=\"p-2 text-dark\" to={config.urls.unpaid}>Unpaid</Link>\r\n        <Link className=\"p-2 text-dark\" to={config.urls.invoiced}>Invoiced</Link>\r\n        <Link className=\"p-2 text-dark\" to={config.urls.paid}>Paid</Link>\r\n        <Link className=\"p-2 text-dark\" to={config.urls.settings}>Settings</Link>\r\n      </nav>\r\n    </header>\r\n  )\r\n};\r\n\r\nexport default Header","import config from '../config.json';\r\nimport useStateWithLocalStorage from '../hooks/useStateWithLocalStorage';\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nconst Settings = () => {\r\n  const [trelloApiKey, setTrelloApiKey] = useStateWithLocalStorage(config.localStorageKeys.trelloApiKey);\r\n  const handleTrelloApiKeyChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setTrelloApiKey(e.target.value);\r\n  }\r\n  \r\n  const [trelloApiToken, setTrelloApiToken] = useStateWithLocalStorage(config.localStorageKeys.trelloApiToken);\r\n  const handleTrelloApiTokenChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setTrelloApiToken(e.target.value);\r\n  }\r\n\r\n  const [payPalClientId, setPayPalClientId] = useStateWithLocalStorage(config.localStorageKeys.payPalClientId);\r\n  const handlePayPalClientIdChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setPayPalClientId(e.target.value);\r\n  }\r\n  \r\n  const [payPalSecret, setPayPalSecret] = useStateWithLocalStorage(config.localStorageKeys.payPalSecret);\r\n  const handlePayPalSecretChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setPayPalSecret(e.target.value);\r\n  }\r\n\r\n  const history = useHistory();\r\n  const handleSubmit = (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    history.push(config.urls.home);\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <h1>Settings</h1>\r\n      <div className=\"row\" style={{maxWidth: 600}}>\r\n        <form onSubmit={handleSubmit}>\r\n          <div className=\"mb-3\">\r\n            <label htmlFor=\"trelloApiKey\" className=\"form-label\">Trello API Key</label>\r\n            <input type=\"text\" className=\"form-control\" id=\"trelloApiKey\" aria-describedby=\"emailHelp\" value={trelloApiKey} onChange={handleTrelloApiKeyChange}/>\r\n          </div>\r\n          <div className=\"mb-3\">\r\n            <label htmlFor=\"trelloApiToken\" className=\"form-label\">Trello API Token</label>\r\n            <input type=\"text\" className=\"form-control\" id=\"trelloApiToken\" value={trelloApiToken} onChange={handleTrelloApiTokenChange}/>\r\n          </div>\r\n          <div className=\"mb-3\">\r\n            <label htmlFor=\"payPalClientId\" className=\"form-label\">PayPal Client Id</label>\r\n            <input type=\"text\" className=\"form-control\" id=\"payPalClientId\" aria-describedby=\"emailHelp\" value={payPalClientId} onChange={handlePayPalClientIdChange}/>\r\n          </div>\r\n          <div className=\"mb-3\">\r\n            <label htmlFor=\"payPalSecret\" className=\"form-label\">PayPal Secret</label>\r\n            <input type=\"text\" className=\"form-control\" id=\"payPalSecret\" value={payPalSecret} onChange={handlePayPalSecretChange}/>\r\n          </div>\r\n          <button type=\"submit\" className=\"btn btn-primary\">Save</button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Settings;","import { TrelloCard } from \"../types\";\r\nimport { getShortCardDescription } from \"../utils\";\r\n\r\nexport interface CardsListProps {\r\n  cards: TrelloCard[];\r\n  altCurrencyRatio?: number;\r\n}\r\n\r\nconst getTotal = (cards: TrelloCard[]): number => {\r\n  return cards.reduce((summ, c) => summ += +c.customFieldItems[0].value.number, 0);\r\n}\r\n\r\nconst CardsList: React.FC<CardsListProps> = (props) => {\r\n  const currentTotal = getTotal(props.cards);\r\n\r\n  return (\r\n    <table className=\"table table-hover table-striped\">\r\n      <thead>\r\n        <tr>\r\n          <th scope=\"col\">#</th>\r\n          <th scope=\"col\">Description</th>\r\n          <th scope=\"col\" align=\"right\" style={{ textAlign: 'right' }}>Cost (USD)</th>\r\n          <th scope=\"col\" align=\"right\" style={{ textAlign: 'right' }}>Cost (RUB)</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        {props.cards.map((c, i) =>\r\n          <tr key={c.id}>\r\n            <th scope=\"row\">{i + 1}</th>\r\n            <td><a className=\"link-dark\" target=\"_blank\" href={c.shortUrl}>{getShortCardDescription(c)}</a></td>\r\n            <td align=\"right\">{c.customFieldItems[0].value.number}</td>\r\n            <td align=\"right\">{props.altCurrencyRatio ? `${(c.customFieldItems[0].value.number * props.altCurrencyRatio).toFixed(0)}` : 'N/A'}</td>\r\n          </tr>\r\n        )}\r\n      </tbody>\r\n      <tfoot>\r\n        <tr>\r\n          <th colSpan={2} scope=\"row\">Total</th>\r\n          <td  align=\"right\"><b>${currentTotal}</b></td>\r\n          <td align=\"right\"><b>{props.altCurrencyRatio ? `${(currentTotal * props.altCurrencyRatio).toFixed(0)}₽` : 'N/A'}</b></td>\r\n        </tr>\r\n      </tfoot>\r\n    </table>\r\n  )\r\n};\r\n\r\nexport default CardsList;","import React, { useEffect, useState } from \"react\";\r\nimport useStateWithLocalStorage from \"../hooks/useStateWithLocalStorage\";\r\nimport config from '../config.json';\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { TrelloCard } from \"../types\";\r\nimport CardsList from \"./CardsList\";\r\nimport { addLabelToCard, createDraftInvoice, getCards, getExchangeRate, getPayPalAuthToken, getPayPalInvoiceTemplate } from \"../utils\";\r\nimport { computeHeadingLevel } from \"@testing-library/react\";\r\n\r\nconst UnpaidDrawings = () => {\r\n  const [apiKey] = useStateWithLocalStorage(config.localStorageKeys.trelloApiKey);\r\n  const [apiToken] = useStateWithLocalStorage(config.localStorageKeys.trelloApiToken);\r\n  const [payPalClientId] = useStateWithLocalStorage(config.localStorageKeys.payPalClientId);\r\n  const [payPalSecret] = useStateWithLocalStorage(config.localStorageKeys.payPalSecret);\r\n\r\n  const history = useHistory();\r\n  if (!apiKey || !apiToken) {\r\n    history.push(config.urls.settings);\r\n  }\r\n\r\n  const [isLoaded, setIsLoaded] = useState<boolean>(false);\r\n  const [altCurrencyRatio, setAltCurrencyRatio] = useState<number | undefined>(undefined);\r\n  const [unpaidCards, setUnpaidCards] = useState<TrelloCard[]>([]);\r\n  const [invoidedCards, setInvoicedCards] = useState<TrelloCard[]>([]);\r\n\r\n  useEffect(() => {\r\n    getExchangeRate(data => setAltCurrencyRatio(data))\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!apiKey || !apiToken) {\r\n      return;\r\n    }\r\n\r\n    const unpaidPromise = getCards(config.trelloLists.sentToClientListId, apiKey, apiToken, (data) => setUnpaidCards(data.filter(c => !c.labels || !c.labels.length)));\r\n    const invoicedPromise = getCards(config.trelloLists.sentToClientListId, apiKey, apiToken, (data) => setInvoicedCards(data.filter(c => c.labels && c.labels.some(l => l.id === config.labelsId.invoiced))));\r\n\r\n    Promise.all([unpaidPromise, invoicedPromise]).then(() => setIsLoaded(true));\r\n  }, [apiKey, apiToken]);\r\n\r\n  const handleCreateInvoiceClick = async () => {\r\n    const token = await getPayPalAuthToken(payPalClientId, payPalSecret);\r\n    const template = await getPayPalInvoiceTemplate(token);\r\n    const response: any = await createDraftInvoice(token, template, unpaidCards);\r\n    \r\n    const chunks = response.href.split('/') as string[];\r\n    const invoiceId = chunks[chunks.length - 1];\r\n    const url = `https://www.paypal.com/invoice/details/${invoiceId}`;\r\n    window.open(url);\r\n  }\r\n\r\n  const handleMakeCardsInvoicedClick = async () => {\r\n    const promises = unpaidCards.map(c => addLabelToCard(c.id, config.labelsId.invoiced, apiKey, apiToken));\r\n    Promise.all(promises).then(() => history.push(config.urls.invoiced));\r\n  }\r\n\r\n  if (!isLoaded) {\r\n    return null;\r\n  }\r\n\r\n  const invoiceButtonText = !payPalClientId || !payPalSecret\r\n    ? 'Provide PayPal settings'\r\n    : invoidedCards.length ? 'Finish Previous Invoice' : 'Make Invoiced';\r\n\r\n  const isInvoiceButtonDisabled = !payPalClientId || !payPalSecret || !!invoidedCards.length;\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"row gy-3\">\r\n        <div className=\"col\">\r\n          <h3>Unpaid Orders</h3>\r\n          <CardsList cards={unpaidCards} altCurrencyRatio={altCurrencyRatio} />\r\n        </div>\r\n      </div>\r\n      <div className=\"row gy-3 \">\r\n        <div className=\"col\">\r\n          <button type=\"button\" className=\"btn btn-outline-primary\" disabled={!!invoidedCards.length} onClick={handleCreateInvoiceClick}>\r\n            {invoiceButtonText}\r\n          </button>\r\n        </div>\r\n        <div className=\"col text-end\">\r\n          <button type=\"button\" className=\"btn btn-outline-primary\" disabled={isInvoiceButtonDisabled} onClick={handleMakeCardsInvoicedClick}>\r\n            {invoidedCards.length ? 'Finish Previous Invoice' : 'Make Invoiced'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default UnpaidDrawings;","import React, { useEffect, useState } from \"react\";\r\nimport useStateWithLocalStorage from \"../hooks/useStateWithLocalStorage\";\r\nimport config from '../config.json';\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { TrelloCard } from \"../types\";\r\nimport CardsList from \"./CardsList\";\r\nimport { addLabelToCard, getCards, getExchangeRate, removeLabelFromCard } from \"../utils\";\r\n\r\nconst InvoicedDrawings = () => {\r\n  const [apiKey] = useStateWithLocalStorage(config.localStorageKeys.trelloApiKey);\r\n  const [apiToken] = useStateWithLocalStorage(config.localStorageKeys.trelloApiToken);\r\n\r\n  const history = useHistory();\r\n  if (!apiKey || !apiToken) {\r\n    history.push(config.urls.settings);\r\n  }\r\n\r\n  const [isLoaded, setIsLoaded] = useState<boolean>(false);\r\n  const [altCurrencyRatio, setAltCurrencyRatio] = useState<number | undefined>(undefined);\r\n  const [cards, setCards] = useState<TrelloCard[]>([]);\r\n\r\n  useEffect(() => {\r\n    getExchangeRate(data => setAltCurrencyRatio(data))\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!apiKey || !apiToken) {\r\n      return;\r\n    }\r\n\r\n    getCards(config.trelloLists.sentToClientListId, apiKey, apiToken, (data) => setCards(data.filter(c => c.labels && c.labels.some(l => l.id === config.labelsId.invoiced))))\r\n      .then(() => setIsLoaded(true));\r\n\r\n  }, [apiKey, apiToken]);\r\n\r\n  const handleMakeUnpaidClick = () => {\r\n    const promises = cards.map(c => removeLabelFromCard(c.id, config.labelsId.invoiced, apiKey, apiToken));\r\n    Promise.all(promises).then(() => history.push(config.urls.unpaid));\r\n  }\r\n\r\n  const handleMakePaidClick = () => {\r\n    const promisesForRemoving = cards.map(c => removeLabelFromCard(c.id, config.labelsId.invoiced, apiKey, apiToken));\r\n    const promisesForAdding = cards.map(c => addLabelToCard(c.id, config.labelsId.paid, apiKey, apiToken));\r\n    Promise.all([...promisesForAdding, ...promisesForRemoving]).then(() => history.push(config.urls.paid));\r\n  }\r\n\r\n  if (!isLoaded) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"row gy-3\">\r\n        <div className=\"col\">\r\n          <h3>Invoiced Orders</h3>\r\n          <CardsList cards={cards} altCurrencyRatio={altCurrencyRatio} />\r\n        </div>\r\n      </div>\r\n      <div className=\"row gy-3 \">\r\n        <div className=\"col\">\r\n          <button type=\"button\" className=\"btn btn-outline-secondary\" onClick={handleMakeUnpaidClick}>Make Unpaid</button>\r\n        </div>\r\n        <div className=\"col text-end\">\r\n          <button type=\"button\" className=\"btn btn-outline-primary\" onClick={handleMakePaidClick}>Make Paid</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default InvoicedDrawings;","import React, { useEffect, useState } from \"react\";\r\nimport useStateWithLocalStorage from \"../hooks/useStateWithLocalStorage\";\r\nimport config from '../config.json';\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { TrelloCard } from \"../types\";\r\nimport CardsList from \"./CardsList\";\r\nimport { getCards, getExchangeRate } from \"../utils\";\r\n\r\nconst PaidDrawings = () => {\r\n  const [apiKey] = useStateWithLocalStorage(config.localStorageKeys.trelloApiKey);\r\n  const [apiToken] = useStateWithLocalStorage(config.localStorageKeys.trelloApiToken);\r\n\r\n  const history = useHistory();\r\n  if (!apiKey || !apiToken) {\r\n    history.push(config.urls.settings);\r\n  }\r\n\r\n  const [isLoaded, setIsLoaded] = useState<boolean>(false);\r\n  const [altCurrencyRatio, setAltCurrencyRatio] = useState<number | undefined>(undefined);\r\n  const [cards, setCards] = useState<TrelloCard[]>([]);\r\n\r\n  useEffect(() => {\r\n    getExchangeRate(data => setAltCurrencyRatio(data))\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!apiKey || !apiToken) {\r\n      return;\r\n    }\r\n\r\n    getCards(config.trelloLists.sentToClientListId, apiKey, apiToken, (data) => setCards(data.filter(c => c.labels && c.labels.some(l => l.id === config.labelsId.paid))))\r\n      .then(() => setIsLoaded(true));\r\n\r\n  }, [apiKey, apiToken]);\r\n  \r\n  if (!isLoaded) {\r\n    return null;\r\n  }\r\n  \r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"row gy-3\">\r\n        <div className=\"col\">\r\n          <h3>Paid Orders</h3>\r\n            <CardsList cards={cards} altCurrencyRatio={altCurrencyRatio} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default PaidDrawings;","import './App.css';\r\nimport Analytics from './Analytics';\r\nimport Header from './Header';\r\nimport React from 'react';\r\nimport { HashRouter as Router, Switch, Route } from \"react-router-dom\";\r\nimport Settings from './Settings';\r\nimport config from '../config.json';\r\nimport UnpaidDrawings from './UnpaidDrawings';\r\nimport InvoicedDrawings from './InvoicedDrawings';\r\nimport PaidDrawings from './PaidDrawings';\r\n\r\nfunction App() {\r\n  return (\r\n    <Router>\r\n      <Header />\r\n      <Switch>\r\n        <Route exact path={config.urls.settings} component={Settings} />\r\n        <Route exact path={config.urls.unpaid} component={UnpaidDrawings} />\r\n        <Route exact path={config.urls.invoiced} component={InvoicedDrawings} />\r\n        <Route exact path={config.urls.paid} component={PaidDrawings} />\r\n        <Route exact path={config.urls.home} component={Analytics} />\r\n      </Switch>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './Components/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}